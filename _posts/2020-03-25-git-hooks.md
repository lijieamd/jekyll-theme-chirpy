---
title: git hook example
date: 2020-03-25 16:22:00 +0800
categories: [Linux]
tags: [linux, git]
seo:
  date_modified: 2020-10-10 13:14:00 +0800
---

# post-receive hook
```shell
#!/bin/bash

WORK_DIR=$(dirname $(realpath "$0"))
BARE_REPOSITORY=$(realpath ${WORK_DIR}/..)
TEMP_REPOSITORY=$(realpath ${BARE_REPOSITORY}/../blog)

echo $WORK_DIR
echo $BARE_REPOSITORY
echo $TEMP_REPOSITORY

if [ -d "$TEMP_REPOSITORY" ]; then rm -Rf $WORKING_DIR; fi
git clone $BARE_REPOSITORY $TEMP_REPOSITORY
pushd $TEMP_REPOSITORY
git checkout master
./tools/docker/build.sh
popd

cp -r $TEMP_REPOSITORY/_site /var/www/html/

GIT_REPO=$HOME/blog.git
TMP_GIT_CLONE=/tmp/blog
PUBLIC_WWW=$HOME/blog

git clone $GIT_REPO $TMP_GIT_CLONE
pushd $TMP_DIRECTORY
bundle exec jekyll build -d $PUBLIC_WWW
popd
rm -rf $TMP_GIT_CLONE

exit

```